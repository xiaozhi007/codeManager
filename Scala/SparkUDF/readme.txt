1、自定义要记得捕捉异常，如果运行中遇到未考虑到的数据，报异常会导致udf函数运行失败；
2、自定义函数，还需要注册为spark sql 函数；
3、注意sql要书写正确；